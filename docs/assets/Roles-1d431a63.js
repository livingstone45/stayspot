import{j as e}from"./charts-2e8e60b5.js";import{r as a}from"./vendor-fb33f09a.js";import{u as G}from"./index-9215bed0.js";import{P as M}from"./plus-e2e8cc52.js";import{S as f}from"./shield-bc169da6.js";import{P as C}from"./pen-2f3092df.js";import{U as k}from"./users-36cd6787.js";import{S as W}from"./search-873dc6ad.js";import{F as q}from"./funnel-2f66c31b.js";import{D as X}from"./download-cea157b8.js";import{L as H}from"./lock-3a762006.js";import{c as J}from"./createLucideIcon-e378a771.js";import{E as A}from"./eye-720b44d1.js";import{C as V}from"./copy-862f97c5.js";import{T as R}from"./trash-2-55d289a1.js";import{C as K}from"./circle-x-c8b2c847.js";import"./router-efb6d4f9.js";import"./maps-2dc382d1.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],Y=J("lock-open",Q),ye=()=>{G();const[N,F]=a.useState([]),[U,S]=a.useState(!0),[L,x]=a.useState(!1),[T,y]=a.useState(!1),[i,l]=a.useState(null),[n,b]=a.useState(null),[w,I]=a.useState(""),[o,h]=a.useState({}),[c,p]=a.useState({name:"",description:"",type:"custom",permissions:{}}),$=[{name:"System",permissions:[{id:"system.view",name:"View System Dashboard",description:"Access to system overview and metrics"},{id:"system.manage",name:"Manage System Settings",description:"Configure system-wide settings"},{id:"system.backup",name:"Perform Backups",description:"Create and manage system backups"},{id:"system.restore",name:"Restore Backups",description:"Restore system from backups"}]},{name:"User Management",permissions:[{id:"users.view",name:"View Users",description:"View all user accounts"},{id:"users.create",name:"Create Users",description:"Create new user accounts"},{id:"users.edit",name:"Edit Users",description:"Edit user account details"},{id:"users.delete",name:"Delete Users",description:"Delete user accounts"},{id:"users.suspend",name:"Suspend Users",description:"Suspend user accounts"}]},{name:"Role Management",permissions:[{id:"roles.view",name:"View Roles",description:"View all roles and permissions"},{id:"roles.create",name:"Create Roles",description:"Create new roles"},{id:"roles.edit",name:"Edit Roles",description:"Edit role permissions"},{id:"roles.delete",name:"Delete Roles",description:"Delete roles"},{id:"roles.assign",name:"Assign Roles",description:"Assign roles to users"}]},{name:"Company Management",permissions:[{id:"companies.view",name:"View Companies",description:"View all companies"},{id:"companies.create",name:"Create Companies",description:"Create new companies"},{id:"companies.edit",name:"Edit Companies",description:"Edit company details"},{id:"companies.delete",name:"Delete Companies",description:"Delete companies"},{id:"companies.billing",name:"Manage Billing",description:"Manage company billing and subscriptions"}]},{name:"Property Management",permissions:[{id:"properties.view_all",name:"View All Properties",description:"View all properties across companies"},{id:"properties.create",name:"Create Properties",description:"Create new properties"},{id:"properties.edit_all",name:"Edit All Properties",description:"Edit any property"},{id:"properties.delete",name:"Delete Properties",description:"Delete properties"},{id:"properties.import",name:"Import Properties",description:"Import properties in bulk"},{id:"properties.export",name:"Export Properties",description:"Export property data"}]},{name:"Financial",permissions:[{id:"financial.view_all",name:"View All Financials",description:"View all financial data"},{id:"financial.process",name:"Process Payments",description:"Process rent payments"},{id:"financial.refund",name:"Issue Refunds",description:"Issue payment refunds"},{id:"financial.reports",name:"Generate Reports",description:"Generate financial reports"},{id:"financial.export",name:"Export Financial Data",description:"Export financial records"}]},{name:"Audit & Security",permissions:[{id:"audit.view",name:"View Audit Logs",description:"View system audit logs"},{id:"audit.export",name:"Export Audit Logs",description:"Export audit log data"},{id:"security.settings",name:"Security Settings",description:"Configure security settings"},{id:"security.monitor",name:"Monitor Security",description:"Monitor security events"},{id:"security.alerts",name:"Manage Security Alerts",description:"Configure security alerts"}]},{name:"Integration",permissions:[{id:"integrations.view",name:"View Integrations",description:"View all integrations"},{id:"integrations.manage",name:"Manage Integrations",description:"Configure integrations"},{id:"integrations.api",name:"API Management",description:"Manage API keys and access"},{id:"integrations.webhooks",name:"Webhook Management",description:"Configure webhooks"}]}];a.useEffect(()=>{v()},[]),a.useEffect(()=>{i?(p({name:i.name,description:i.description,type:i.type||"custom",permissions:i.permissions||{}}),h(i.permissions||{})):u()},[i]);const v=async()=>{S(!0);try{const s=await getRoles();F(s)}catch(s){console.error("Failed to load roles:",s)}finally{S(!1)}},u=()=>{p({name:"",description:"",type:"custom",permissions:{}}),h({})},_=s=>{h(t=>({...t,[s]:!t[s]}))},B=s=>{const t=s.permissions.map(m=>m.id),d=t.every(m=>o[m]),g={...o};t.forEach(m=>{g[m]=!d}),h(g)},D=async s=>{s.preventDefault();const t={...c,permissions:o};try{i?await updateRole(i.id,t):await createRole(t),v(),x(!1),l(null),u()}catch(d){console.error("Failed to save role:",d)}},O=async()=>{if(n)try{await deleteRole(n.id),v(),y(!1),b(null)}catch(s){console.error("Failed to delete role:",s)}},E=s=>{l(null),p({name:`${s.name} (Copy)`,description:s.description,type:s.type,permissions:s.permissions}),h(s.permissions||{}),x(!0)},P=N.filter(s=>s.name.toLowerCase().includes(w.toLowerCase())||s.description.toLowerCase().includes(w.toLowerCase())),j=P.filter(s=>s.type==="custom"),z=P.filter(s=>s.type!=="custom");return U?e.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"h-20 bg-gray-200 rounded-lg"},s))})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Role Management"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Define and manage user roles and permissions across the platform"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs("button",{onClick:()=>{l(null),u(),x(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Create New Role"]})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[{label:"Total Roles",value:N.length,icon:f,color:"blue"},{label:"Custom Roles",value:j.length,icon:C,color:"green"},{label:"Users with Roles",value:N.reduce((s,t)=>s+(t.userCount||0),0),icon:k,color:"purple"}].map((s,t)=>e.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-lg bg-${s.color}-100 mr-4`,children:e.jsx(s.icon,{className:`w-6 h-6 text-${s.color}-600`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.value}),e.jsx("p",{className:"text-sm text-gray-600",children:s.label})]})]})},t))}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between",children:[e.jsx("div",{className:"flex-1 max-w-md mb-4 md:mb-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search roles by name or description...",value:w,onChange:s=>I(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Filter"]}),e.jsxs("button",{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Export"]})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"System Roles"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:z.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.color} mr-3`,children:e.jsx(f,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center mt-1",children:[s.locked?e.jsx(H,{className:"w-3 h-3 text-gray-400 mr-1"}):e.jsx(Y,{className:"w-3 h-3 text-gray-400 mr-1"}),e.jsx("span",{className:"text-xs text-gray-500",children:s.locked?"System Role":"Custom Role"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>l(s),className:"p-1 text-gray-400 hover:text-blue-600",title:"View Details",children:e.jsx(A,{className:"w-4 h-4"})}),!s.locked&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>l(s),className:"p-1 text-gray-400 hover:text-green-600",title:"Edit",children:e.jsx(C,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>E(s),className:"p-1 text-gray-400 hover:text-purple-600",title:"Duplicate",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{b(s),y(!0)},className:"p-1 text-gray-400 hover:text-red-600",title:"Delete",children:e.jsx(R,{className:"w-4 h-4"})})]})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[s.userCount||0," users"]})]}),e.jsxs("div",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded-full",children:[Object.keys(s.permissions||{}).length," permissions"]})]})]},s.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Custom Roles"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[j.length," roles"]})]}),j.length>0?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Users"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Permissions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.color||"bg-gray-100"} mr-3`,children:e.jsx(f,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.type})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:s.description})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:s.userCount||0})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-700",children:[Object.keys(s.permissions||{}).filter(t=>s.permissions[t]).length," enabled"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>l(s),className:"text-blue-600 hover:text-blue-900",title:"View",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>l(s),className:"text-green-600 hover:text-green-900",title:"Edit",children:e.jsx(C,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>E(s),className:"text-purple-600 hover:text-purple-900",title:"Duplicate",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{b(s),y(!0)},className:"text-red-600 hover:text-red-900",title:"Delete",children:e.jsx(R,{className:"w-4 h-4"})})]})})]},s.id))})]})}):e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(f,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No custom roles yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first custom role to define specific permission sets for your users."}),e.jsxs("button",{onClick:()=>{l(null),u(),x(!0)},className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Create Custom Role"]})]})]}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:i?"Edit Role":"Create New Role"}),e.jsx("button",{onClick:()=>{x(!1),l(null),u()},className:"text-gray-400 hover:text-gray-600",children:e.jsx(K,{className:"w-6 h-6"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("form",{onSubmit:D,className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Name *"}),e.jsx("input",{type:"text",required:!0,value:c.name,onChange:s=>p({...c,name:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Regional Manager, Finance Admin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Type"}),e.jsxs("select",{value:c.type,onChange:s=>p({...c,type:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"custom",children:"Custom"}),e.jsx("option",{value:"system",children:"System"}),e.jsx("option",{value:"company",children:"Company"}),e.jsx("option",{value:"user",children:"User"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:c.description,onChange:s=>p({...c,description:s.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe the purpose and scope of this role..."})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Permissions"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[Object.values(o).filter(s=>s).length," permissions selected"]})]}),e.jsx("div",{className:"space-y-6",children:$.map(s=>{const t=s.permissions.map(r=>r.id),d=t.filter(r=>o[r]).length,g=d===t.length,m=d>0&&!g;return e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:g,ref:r=>{r&&(r.indeterminate=m)},onChange:()=>B(s),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{className:"ml-3 font-medium text-gray-900",children:s.name})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[d," of ",t.length," selected"]})]})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.permissions.map(r=>e.jsx("div",{className:`p-3 rounded-lg border ${o[r.id]?"border-blue-200 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{type:"checkbox",id:r.id,checked:!!o[r.id],onChange:()=>_(r.id),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("label",{htmlFor:r.id,className:"text-sm font-medium text-gray-900 cursor-pointer",children:r.name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r.description})]})]})},r.id))})})]},s.name)})})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{x(!1),l(null),u()},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:D,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:i?"Update Role":"Create Role"})]})})]})}),T&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4",children:e.jsx(R,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 text-center mb-2",children:"Delete Role"}),e.jsxs("p",{className:"text-gray-600 text-center mb-4",children:['Are you sure you want to delete the role "',n.name,'"?']}),n.userCount>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(AlertTriangle,{className:"w-5 h-5 text-yellow-400 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"Warning"}),e.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["This role is assigned to ",n.userCount," user",n.userCount!==1?"s":"",". Deleting it will remove their permissions."]})]})]})}),e.jsxs("div",{className:"flex justify-center space-x-3",children:[e.jsx("button",{onClick:()=>{y(!1),b(null)},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:O,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete Role"})]})]})})]})})};export{ye as default};
//# sourceMappingURL=Roles-1d431a63.js.map
